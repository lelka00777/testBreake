<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ–Ω—Ç—Ä–æ–ª—å –ø–µ—Ä–µ—Ä—ã–≤–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 10px;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 0 12px rgba(0, 0, 0, 0.1);
            padding: 12px;
            overflow-x: auto;
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #eee;
            font-size: 1.4rem;
        }
        
        .controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 12px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
        }
        
        .input-group {
            width: 100%;
        }
        
        label {
            display: block;
            margin-bottom: 4px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.85rem;
        }
        
        input, select, button {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        button {
            background: #3498db;
            color: white;
            border: none;
            cursor: pointer;
            transition: background 0.3s;
            font-weight: 600;
            padding: 10px;
        }
        
        button:hover {
            background: #2980b9;
        }
        
        .timeline-container {
            overflow-x: auto;
            margin-bottom: 15px;
            -webkit-overflow-scrolling: touch;
        }
        
        /* –£–ù–ò–§–ò–ö–ê–¶–ò–Ø –ú–ê–°–®–¢–ê–ë–ê: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º 100px */
        .timeline-header {
            display: flex;
            height: 30px;
            margin-left: 100px; 
            min-width: max-content;
        }
        
        /* –£–ù–ò–§–ò–ö–ê–¶–ò–Ø –ú–ê–°–®–¢–ê–ë–ê: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º 100px */
        .timeline-footer {
            display: flex;
            height: 30px;
            margin-left: 100px;
            min-width: max-content;
            margin-top: 5px;
        }
        
        /* –£–ù–ò–§–ò–ö–ê–¶–ò–Ø –ú–ê–°–®–¢–ê–ë–ê: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º 24px */
        .time-slot {
            flex: 0 0 24px;
            text-align: center;
            padding: 6px 0;
            font-size: 0.65rem;
            border-left: 1px solid #ddd;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 24px;
        }
        
        .employee-row {
            display: flex;
            min-height: 50px; /* –ù–µ–º–Ω–æ–≥–æ —É–º–µ–Ω—å—à–µ–Ω –¥–ª—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ */
            margin-bottom: 8px;
            border-bottom: 1px solid #eee;
            min-width: max-content;
        }
        
        /* –£–ù–ò–§–ò–ö–ê–¶–ò–Ø –ú–ê–°–®–¢–ê–ë–ê: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º 100px */
        .employee-info {
            flex: 0 0 100px;
            padding: 6px;
            background: #ecf0f1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            border-right: 2px solid #bdc3c7;
            min-width: 100px;
            position: sticky;
            left: 0;
            z-index: 2;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –∏–Ω–ø—É—Ç-–ø–æ–ª—è, –∫–æ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ */
        .employee-info input[type="text"] {
            padding: 3px;
            border: 1px solid #3498db;
            border-radius: 3px;
            font-size: inherit;
        }
        
        .employee-name {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 2px;
            cursor: pointer; /* –î–ª—è dblclick */
        }
        
        .employee-position {
            font-size: 0.75rem;
            color: #7f8c8d;
            cursor: pointer; /* –î–ª—è dblclick */
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ */
        .employee-work-hours {
            font-size: 0.75rem;
            color: #3498db; 
            font-weight: 600;
            margin-bottom: 6px;
        }

        .employee-total-breaks {
            font-size: 0.75rem;
            color: #e74c3c; 
            font-weight: 600;
            margin-bottom: 6px;
        }
        
        .time-cells {
            display: flex;
            flex: 1;
            min-width: max-content;
        }
        
        /* –£–ù–ò–§–ò–ö–ê–¶–ò–Ø –ú–ê–°–®–¢–ê–ë–ê: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º 24px */
        .time-cell {
            flex: 0 0 24px;
            border: 1px solid #ddd;
            border-left: none;
            /* **–ë–õ–ï–î–ù–û-–°–ò–ù–ò–ô**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ù–ï–†–ê–ë–û–ß–ï–ì–û –≤—Ä–µ–º–µ–Ω–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ */
            background: #f0f8ff; 
            transition: background 0.2s;
            min-width: 24px;
        }

        /* **–ù–ê–°–´–©–ï–ù–ù–´–ô –°–ò–ù–ò–ô**: –†–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ */
        .time-cell.working-time-cell {
            background: #3498db; 
            background: linear-gradient(to right, #3498db, #4aa8de);
        }
        
        .time-cell.break {
            background: #e74c3c; /* Base Break Color - –ö—Ä–∞—Å–Ω—ã–π */
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–Ω—ã—Ö –∑–æ–Ω */
        .time-cell.conflict {
            background: #c0392b; /* Darker red for 2+ simultaneous breaks */
            border: 1px dashed #fff !important; 
        }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin: 12px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 0.85rem;
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
        }
        
        .working-time {
            /* –ù–∞—Å—ã—â–µ–Ω–Ω—ã–π —Å–∏–Ω–∏–π */
            background: #3498db; 
            border: 1px solid #ddd;
        }

        .non-working-time {
            /* –ë–ª–µ–¥–Ω–æ-—Å–∏–Ω–∏–π */
            background: #f0f8ff;
            border: 1px solid #ddd;
        }
        
        .break-time {
            background: #e74c3c;
        }
        
        .conflict-time {
            background: #c0392b;
            border: 1px dashed #fff;
        }
        
        .employee-controls {
            display: flex;
            gap: 6px;
            flex-direction: column;
        }
        
        .employee-controls button {
            padding: 5px;
            font-size: 0.7rem;
        }
        
        .show-breaks-btn {
            background: #9b59b6;
        }
        
        .show-breaks-btn:hover {
            background: #8e44ad;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ "–ò–∑–º–µ–Ω–∏—Ç—å" —É–¥–∞–ª–µ–Ω–∞ */
        
        .action-buttons {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            flex-wrap: wrap;
        }
        
        .action-buttons button {
            flex: 1;
            min-width: 140px;
        }
        
        .view-schedule {
            background: #27ae60;
        }
        
        .view-schedule:hover {
            background: #219653;
        }
        
        .clear-data {
            background: #e74c3c;
        }
        
        .clear-data:hover {
            background: #c0392b;
        }
        
        .data-menu {
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .menu-btn {
            background: #9b59b6;
            position: relative;
            padding-right: 30px;
        }
        
        .menu-btn:hover {
            background: #8e44ad;
        }
        
        .menu-btn::after {
            content: "‚ñæ";
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
        }
        
        .dropdown {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            margin-top: 5px;
        }
        
        .dropdown.show {
            display: block;
        }
        
        .dropdown button {
            background: none;
            color: #333;
            border: none;
            border-bottom: 1px solid #eee;
            border-radius: 0;
            text-align: left;
            padding: 12px 15px;
            font-weight: normal;
        }
        
        .dropdown button:hover {
            background: #f8f9fa;
            color: #2c3e50;
        }
        
        .dropdown button:last-child {
            border-bottom: none;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 15px;
        }
        
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            width: 90%;
            max-width: 400px;
            max-height: 90%;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #7f8c8d;
            width: auto;
        }
        
        .breaks-list {
            margin-top: 10px;
            overflow-y: auto;
            max-height: 300px;
        }
        
        .break-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 4px;
        }
        
        .break-actions {
            display: flex;
            gap: 5px;
        }
        
        .break-actions button {
            padding: 4px 8px;
            font-size: 0.7rem;
        }
        
        .total-breaks {
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px solid #ddd;
            font-weight: bold;
        }
        
        .add-break-form {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 4px;
        }
        
        .form-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .form-row .input-group {
            flex: 1;
        }
        
        .pdf-view {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 1001;
            overflow: hidden;
            flex-direction: column;
        }
        
        .pdf-header {
            text-align: center;
            margin-bottom: 15px;
            padding: 15px 10px 10px 10px;
            border-bottom: 2px solid #eee;
            flex-shrink: 0;
        }
        
        .pdf-timeline-container {
            width: 100%;
            flex: 1;
            overflow: auto;
            padding: 0 10px;
        }
        
        .pdf-timeline-header {
            display: flex;
            height: 25px;
            margin-left: 100px;
            min-width: max-content;
        }
        
        .pdf-timeline-footer {
            display: flex;
            height: 25px;
            margin-left: 100px;
            min-width: max-content;
            margin-top: 5px;
        }
        
        .pdf-time-slot {
            flex: 0 0 24px;
            text-align: center;
            padding: 4px 0;
            font-size: 0.6rem;
            border-left: 1px solid #ddd;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 24px;
        }
        
        .pdf-employee-row {
            display: flex;
            min-height: 45px;
            margin-bottom: 6px;
            min-width: max-content;
        }
        
        .pdf-employee-info {
            flex: 0 0 100px;
            padding: 4px;
            background: #ecf0f1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            border-right: 2px solid #bdc3c7;
            font-size: 0.75rem;
            min-width: 100px;
            position: sticky;
            left: 0;
            z-index: 2;
        }
        
        .pdf-time-cells {
            display: flex;
            flex: 1;
            min-width: max-content;
        }
        
        .pdf-time-cell {
            flex: 0 0 24px;
            border: 1px solid #ddd;
            border-left: none;
            /* –ë–ª–µ–¥–Ω–æ-—Å–∏–Ω–∏–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è –ù–µ—Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤ PDF */
            background: #f0f8ff;
            min-width: 24px;
        }

        /* –ù–∞—Å—ã—â–µ–Ω–Ω—ã–π —Å–∏–Ω–∏–π –¥–ª—è —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤ PDF */
        .pdf-time-cell.working-time-cell {
            background: #3498db; 
            background: linear-gradient(to right, #3498db, #4aa8de);
        }
        
        .pdf-time-cell.break {
            background: #e74c3c;
        }
        
        /* –°—Ç–∏–ª—å –¥–ª—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–Ω—ã—Ö –∑–æ–Ω –≤ PDF */
        .pdf-time-cell.conflict {
            background: #c0392b; 
            border: 1px dashed #fff !important;
        }

        .pdf-close {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 1002;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .share-container {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin: 15px 0;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 6px;
            flex-wrap: wrap;
            flex-shrink: 0;
        }
        
        .share-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            transition: background 0.3s;
            width: 55px;
            height: 55px;
        }
        
        .share-btn:hover {
            background: #e8f4fc;
        }
        
        .share-icon {
            width: 25px;
            height: 25px;
            margin-bottom: 4px;
        }
        
        .share-text {
            font-size: 0.65rem;
            color: #2c3e50;
        }
        
        .preview-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1003;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .preview-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            text-align: center;
        }
        
        .preview-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .preview-buttons button {
            width: auto;
            padding: 10px 20px;
        }
        
        @media (max-width: 480px) {
            /* –£–ù–ò–§–ò–ö–ê–¶–ò–Ø –ú–ê–õ–ï–ù–¨–ö–ò–• –≠–ö–†–ê–ù–û–í: –¥–µ–ª–∞–µ–º –ø–ª–æ—Ç–Ω–µ–µ */
            .time-slot, .time-cell {
                flex: 0 0 24px;
                min-width: 24px;
                font-size: 0.55rem;
            }
            
            .employee-info {
                flex: 0 0 85px; /* –ù–µ–º–Ω–æ–≥–æ –º–µ–Ω—å—à–µ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
                min-width: 85px;
            }

            .timeline-header, .timeline-footer {
                margin-left: 85px; 
            }
            
            .employee-name {
                font-size: 0.8rem;
            }
            
            .employee-position {
                font-size: 0.7rem;
            }
            
            .pdf-time-slot, .pdf-time-cell {
                flex: 0 0 22px;
                min-width: 22px;
                font-size: 0.55rem;
            }
            
            .pdf-employee-info {
                flex: 0 0 85px;
                min-width: 85px;
                font-size: 0.65rem;
            }
            
            .pdf-timeline-header, .pdf-timeline-footer {
                margin-left: 85px;
            }
            
            .share-btn {
                width: 50px;
                height: 50px;
            }
            
            .share-icon {
                width: 22px;
                height: 22px;
            }
            
            .action-buttons button {
                min-width: 120px;
            }
        }
        
        @media (orientation: landscape) {
            .pdf-timeline-container {
                transform: scale(0.85);
                transform-origin: top center;
            }
        }
        
        @media (orientation: portrait) {
            .pdf-timeline-container {
                transform: scale(0.9);
                transform-origin: top center;
            }
        }
        
        .export-container {
            width: 100%;
            overflow: auto;
        }
        
        .file-input {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>–ö–æ–Ω—Ç—Ä–æ–ª—å –ø–µ—Ä–µ—Ä—ã–≤–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</h1>
        
        <div class="controls">
            <p style="font-size: 0.75rem; color: #7f8c8d; margin-bottom: 5px;">* –≠—Ç–∏ –ø–æ–ª—è –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç **–æ–±—â—É—é –æ–±–ª–∞—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è** —Ç–∞–π–º–ª–∞–π–Ω–∞.</p>
            <div class="input-group-row" style="display: flex; gap: 10px;">
                <div class="input-group" style="flex: 1;">
                    <label for="shiftStart">–ù–∞—á–∞–ª–æ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Ç–∞–π–º–ª–∞–π–Ω–∞</label>
                    <input type="time" id="shiftStart" step="900" value="09:45">
                </div>
                <div class="input-group" style="flex: 1;">
                    <label for="shiftEnd">–ö–æ–Ω–µ—Ü –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Ç–∞–π–º–ª–∞–π–Ω–∞</label>
                    <input type="time" id="shiftEnd" step="900" value="22:45">
                </div>
            </div>
            
            <div class="input-group">
                <label for="employeeName">–ò–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</label>
                <input type="text" id="employeeName" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
            </div>
            
            <div class="input-group">
                <label for="employeePosition">–î–æ–ª–∂–Ω–æ—Å—Ç—å</label>
                <input type="text" id="employeePosition" placeholder="–í–≤–µ–¥–∏—Ç–µ –¥–æ–ª–∂–Ω–æ—Å—Ç—å">
            </div>

            <div class="input-group-row" style="display: flex; gap: 10px;">
                <div class="input-group" style="flex: 1;">
                    <label for="employeeShiftStart">–ù–∞—á–∞–ª–æ —Å–º–µ–Ω—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</label>
                    <input type="time" id="employeeShiftStart" step="900" value="09:45">
                </div>
                <div class="input-group" style="flex: 1;">
                    <label for="employeeShiftEnd">–ö–æ–Ω–µ—Ü —Å–º–µ–Ω—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</label>
                    <input type="time" id="employeeShiftEnd" step="900" value="22:45">
                </div>
            </div>
            
            <div class="input-group">
                <label>&nbsp;</label>
                <button id="addEmployee">–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</button>
            </div>
        </div>
        
        <div class="timeline-container">
            <div class="timeline-header" id="timelineHeader">
                </div>
            
            <div id="employeesContainer">
                </div>
            
            <div class="timeline-footer" id="timelineFooter">
                </div>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color working-time"></div>
                <span>–†–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (–ù–∞—Å—ã—â–µ–Ω–Ω–æ-—Å–∏–Ω–∏–π)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color non-working-time"></div>
                <span>–ù–µ—Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è (–ë–ª–µ–¥–Ω–æ-—Å–∏–Ω–∏–π)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color break-time"></div>
                <span>–ü–µ—Ä–µ—Ä—ã–≤ (–ö—Ä–∞—Å–Ω—ã–π)</span>
            </div>
             <div class="legend-item">
                <div class="legend-color conflict-time"></div>
                <span>–ö–æ–Ω—Ñ–ª–∏–∫—Ç (2+ –ø–µ—Ä–µ—Ä—ã–≤–∞)</span>
            </div>
        </div>
        
        <div class="action-buttons">
            <button class="view-schedule" id="viewSchedule">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≥—Ä–∞—Ñ–∏–∫</button>
            <button class="clear-data" id="clearData">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
            <div class="data-menu">
                <button class="menu-btn" id="dataMenuBtn">‚ñæ –î–∞–Ω–Ω—ã–µ</button>
                <div class="dropdown" id="dataDropdown">
                    <button onclick="exportToJSON()">üì§ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å </button>
                    <button onclick="importJSON()">üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                    <button onclick="copySchedule('brief')">üìã –ö—Ä–∞—Ç–∫–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</button>
                    <button onclick="copySchedule('detailed')">üìä –î–µ—Ç–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</button>
                </div>
            </div>
        </div>

        <input type="file" id="jsonFileInput" class="file-input" accept=".json">
    </div>

    <div class="pdf-view" id="pdfView">
        <button class="pdf-close" id="pdfClose">√ó</button>
        <div class="pdf-header">
            <h2>–ì—Ä–∞—Ñ–∏–∫ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</h2>
            <p id="pdfDate"></p>
        </div>
        
        <div class="share-container">
            <button class="share-btn" onclick="showPreview('telegram')">
                <svg class="share-icon" viewBox="0 0 24 24" fill="#0088cc">
                    <path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.894 8.221l-1.97 9.28c-.145.658-.537.818-1.084.508l-3-2.21-1.447 1.394c-.16.160-.295.295-.605.295l.213-3.053 5.56-5.022c.242-.213-.054-.334-.373-.121l-6.869 4.326-2.96-.924c-.64-.203-.652-.64.136-.954l11.566-4.458c.538-.196 1.006.128.832.941z"/>
                </svg>
                <span class="share-text">Telegram</span>
            </button>
            
            <button class="share-btn" onclick="showPreview('whatsapp')">
                <svg class="share-icon" viewBox="0 0 24 24" fill="#25D366">
                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.150-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.864 3.488"/>
                </svg>
                <span class="share-text">WhatsApp</span>
            </button>
            
            <button class="share-btn" onclick="showPreview('pdf')">
                <svg class="share-icon" viewBox="0 0 24 24" fill="#e74c3c">
                    <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zM8.5 16.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.79-5.5L9 11H6.5l4.5-4.5V10c0 .55.45 1 1 1h1.5v2.5H10.29z"/>
                </svg>
                <span class="share-text">PDF</span>
            </button>
            
            <button class="share-btn" onclick="showPreview('image')">
                <svg class="share-icon" viewBox="0 0 24 24" fill="#3498db">
                    <path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4.86 8.86l-3 3.87L9 13.14 6 17h12l-3.86-5.14z"/>
                </svg>
                <span class="share-text">JPG</span>
            </button>
        </div>
        <div class="pdf-timeline-container">
            <div class="pdf-timeline-header" id="pdfTimelineHeader"> </div>
            <div id="pdfEmployeesContainer"> </div>
            <div class="pdf-timeline-footer" id="pdfTimelineFooter"> </div> </div>
    </div>

    <div class="modal" id="breaksModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalEmployeeName">–ü–µ—Ä–µ—Ä—ã–≤—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h2>
                <button class="close-modal" onclick="closeBreaksModal()">&times;</button>
            </div>
            <div class="add-break-form">
                <h3>–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ—Ä—ã–≤</h3>
                <div class="form-row">
                    <div class="input-group">
                        <label for="modalBreakStart">–ù–∞—á–∞–ª–æ –ø–µ—Ä–µ—Ä—ã–≤–∞</label>
                        <input type="time" id="modalBreakStart" step="900" value="13:00">
                    </div>
                    <div class="input-group">
                        <label for="modalBreakDuration">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</label>
                        <select id="modalBreakDuration">
                            <option value="15">15 –º–∏–Ω—É—Ç</option>
                            <option value="30" selected>30 –º–∏–Ω—É—Ç</option>
                            <option value="45">45 –º–∏–Ω—É—Ç</option>
                            <option value="60">1 —á–∞—Å</option>
                            <option value="75">1 —á–∞—Å 15 –º–∏–Ω</option>
                            <option value="90">1 —á–∞—Å 30 –º–∏–Ω</option>
                            <option value="105">1 —á–∞—Å 45 –º–∏–Ω</option>
                        </select>
                    </div>
                </div>
                <button id="modalAddBreak">–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ—Ä—ã–≤</button>
            </div>
            <div class="breaks-list" id="breaksList"> </div>
            <div class="total-breaks" id="totalBreaks"> </div>
        </div>
    </div>

    <div class="preview-modal" id="previewModal">
        <div class="preview-content">
            <h2>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä</h2>
            <p>–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å/—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫?</p>
            <div class="preview-buttons">
                <button id="confirmAction" style="background: #27ae60;">–î–∞</button>
                <button onclick="closePreviewModal()" style="background: #95a5a6;">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const { jsPDF } = window.jspdf;

            // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. workStart/workEnd –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –û–ë–©–£–Æ –æ–±–ª–∞—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–∞–π–º–ª–∞–π–Ω–∞.
            let globalWorkStart = new Date();
            let globalWorkEnd = new Date();
            const timeInterval = 15; // minutes
            let employees = [];
            let selectedEmployeeId = null;
            let currentModalEmployeeId = null;
            let currentAction = null;

            const shiftStartInput = document.getElementById('shiftStart');
            const shiftEndInput = document.getElementById('shiftEnd');
            const employeesContainer = document.getElementById('employeesContainer');
            const timelineHeader = document.getElementById('timelineHeader');
            const timelineFooter = document.getElementById('timelineFooter');
            const pdfEmployeesContainer = document.getElementById('pdfEmployeesContainer');
            const viewScheduleBtn = document.getElementById('viewSchedule');
            const pdfView = document.getElementById('pdfView');
            const pdfCloseBtn = document.getElementById('pdfClose');
            const dataMenuBtn = document.getElementById('dataMenuBtn');
            const dataDropdown = document.getElementById('dataDropdown');
            const clearDataBtn = document.getElementById('clearData');
            const addEmployeeBtn = document.getElementById('addEmployee');
            const modalAddBreakBtn = document.getElementById('modalAddBreak');
            const breaksList = document.getElementById('breaksList');
            const previewModal = document.getElementById('previewModal');
            const confirmActionButton = document.getElementById('confirmAction');
            const totalBreaksDisplay = document.getElementById('totalBreaks');

            // === –£–¢–ò–õ–ò–¢–´ –î–õ–Ø –í–†–ï–ú–ï–ù–ò ===

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∏–Ω—É—Ç –≤ —Ñ–æ—Ä–º–∞—Ç –ß–ß:–ú–ú
            function convertMinutesToHours(minutes) {
                if (minutes < 0 || isNaN(minutes)) return '00:00';
                const h = Math.floor(minutes / 60);
                const m = minutes % 60;
                const hours = String(h).padStart(2, '0');
                const mins = String(m).padStart(2, '0');
                return `${hours}:${mins}`;
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (–¥–ª—è –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞)
            function calculateTotalBreakTime(employeeId) {
                const employee = employees.find(emp => emp.id === employeeId);
                if (!employee || !employee.breaks) return 0;

                return employee.breaks.reduce((total, breakItem) => {
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º Math.max(0, ...) –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                    const durationMs = Math.max(0, breakItem.end.getTime() - breakItem.start.getTime());
                    const durationMinutes = Math.round(durationMs / 60000); 
                    return total + durationMinutes;
                }, 0);
            }

            function timeToMinutes(timeString) {
                const [hours, minutes] = timeString.split(':').map(Number);
                return hours * 60 + minutes;
            }

            function minutesToTime(totalMinutes) {
                const hours = Math.floor(totalMinutes / 60);
                const minutes = totalMinutes % 60;
                return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}`;
            }

            function getTimeDifferenceIn15MinIntervals(start, end) {
                if (start > end) return 0;
                const diffMs = end.getTime() - start.getTime();
                // 15 minutes in milliseconds
                const intervalMs = timeInterval * 60 * 1000; 
                return Math.ceil(diffMs / intervalMs); 
            }

            // === –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –†–ï–ù–î–ï–†–ò–ù–ì–ê ===

            // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤/—Ñ—É—Ç–µ—Ä–æ–≤ —Ç–∞–π–º–ª–∞–π–Ω–∞
            function generateTimelineHeaders(isPdf = false) {
                const startMinutes = timeToMinutes(minutesToTime(timeToMinutes(shiftStartInput.value))); // –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ 15 –º–∏–Ω—É—Ç
                const endMinutes = timeToMinutes(minutesToTime(timeToMinutes(shiftEndInput.value)));     // –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ 15 –º–∏–Ω—É—Ç

                const numSlots = (endMinutes - startMinutes) / timeInterval;

                // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
                const headerContainer = isPdf ? document.getElementById('pdfTimelineHeader') : timelineHeader;
                const footerContainer = isPdf ? document.getElementById('pdfTimelineFooter') : timelineFooter;

                headerContainer.innerHTML = '';
                footerContainer.innerHTML = '';

                // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ —Å–ª–æ—Ç–∞
                const slotClass = isPdf ? 'pdf-time-slot' : 'time-slot';
                
                for (let i = 0; i < numSlots; i++) {
                    const currentMinutes = startMinutes + i * timeInterval;
                    const timeString = minutesToTime(currentMinutes);

                    // –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ—Ç–∞ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞
                    const headerSlot = document.createElement('div');
                    headerSlot.className = slotClass;
                    headerSlot.textContent = timeString;
                    headerContainer.appendChild(headerSlot);
                    
                    // –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ—Ç–∞ –¥–ª—è —Ñ—É—Ç–µ—Ä–∞ (–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï)
                    const footerSlot = document.createElement('div');
                    footerSlot.className = slotClass;
                    footerSlot.textContent = timeString;
                    footerContainer.appendChild(footerSlot);
                }
            }

            function renderEmployees() {
                employeesContainer.innerHTML = '';
                generateTimelineHeaders();
                
                const globalStartMinutes = timeToMinutes(shiftStartInput.value);
                
                employees.forEach(employee => {
                    const employeeRow = document.createElement('div');
                    employeeRow.className = 'employee-row';
                    employeeRow.dataset.id = employee.id;

                    // –†–∞—Å—á–µ—Ç –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤
                    const totalBreakMinutes = calculateTotalBreakTime(employee.id);
                    const totalBreakTimeFormatted = convertMinutesToHours(totalBreakMinutes);

                    // –ò–ù–§–û–†–ú–ê–¶–ò–û–ù–ù–´–ô –ë–õ–û–ö (–° dblclick –∏ –û–±—â–∏–º –≤—Ä–µ–º–µ–Ω–µ–º –ø–µ—Ä–µ—Ä—ã–≤–æ–≤)
                    let html = `<div class="employee-info">
                        <span class="employee-name" ondblclick="enableEdit('${employee.id}', 'name', this)">${employee.name}</span>
                        <span class="employee-position" ondblclick="enableEdit('${employee.id}', 'position', this)">${employee.position}</span>
                        <div class="employee-work-hours">–°–º–µ–Ω–∞: ${employee.shiftStart} - ${employee.shiftEnd}</div>
                        <div class="employee-total-breaks">
                            –í—Å–µ–≥–æ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤: ${totalBreakTimeFormatted}
                        </div>
                        <div class="employee-controls">
                            <button class="show-breaks-btn" onclick="showBreaks('${employee.id}')">–ü–µ—Ä–µ—Ä—ã–≤—ã</button>
                            <button class="clear-data" onclick="removeEmployee('${employee.id}')" style="background: #c0392b;">–£–¥–∞–ª–∏—Ç—å</button>
                        </div>
                    </div>`;

                    // –¢–ê–ô–ú–õ–ê–ô–ù
                    html += '<div class="time-cells">';

                    const employeeStartMinutes = timeToMinutes(employee.shiftStart);
                    const employeeEndMinutes = timeToMinutes(employee.shiftEnd);
                    
                    const totalSlots = getTimeDifferenceIn15MinIntervals(globalWorkStart, globalWorkEnd);
                    
                    for (let i = 0; i < totalSlots; i++) {
                        const slotMinutes = globalStartMinutes + i * timeInterval;
                        const slotEndMinutes = slotMinutes + timeInterval;
                        let cellClass = 'time-cell';

                        // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
                        const isWorkingTime = slotMinutes < employeeEndMinutes && slotEndMinutes > employeeStartMinutes;
                        if (isWorkingTime) {
                            cellClass += ' working-time-cell';
                        }
                        
                        // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–µ—Ä–µ—Ä—ã–≤
                        let isBreak = false;
                        for (const breakItem of employee.breaks) {
                            const breakStartMinutes = timeToMinutes(minutesToTime(breakItem.start.getHours() * 60 + breakItem.start.getMinutes()));
                            const breakEndMinutes = timeToMinutes(minutesToTime(breakItem.end.getHours() * 60 + breakItem.end.getMinutes()));

                            if (slotMinutes < breakEndMinutes && slotEndMinutes > breakStartMinutes) {
                                isBreak = true;
                                break;
                            }
                        }

                        if (isBreak) {
                            cellClass += ' break';
                        }
                        
                        // 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç
                        const conflictCount = employees.reduce((count, otherEmployee) => {
                            if (otherEmployee.id === employee.id) return count;

                            const isOtherWorking = slotMinutes < timeToMinutes(otherEmployee.shiftEnd) && slotEndMinutes > timeToMinutes(otherEmployee.shiftStart);
                            if (!isOtherWorking) return count; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–µ—Ä–∞–±–æ—Ç–∞—é—â–∏—Ö

                            for (const otherBreak of otherEmployee.breaks) {
                                const otherBreakStartMinutes = timeToMinutes(minutesToTime(otherBreak.start.getHours() * 60 + otherBreak.start.getMinutes()));
                                const otherBreakEndMinutes = timeToMinutes(minutesToTime(otherBreak.end.getHours() * 60 + otherBreak.end.getMinutes()));
                                
                                // –ï—Å–ª–∏ –≤ —ç—Ç–æ—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª –µ—Å—Ç—å –ø–µ—Ä–µ—Ä—ã–≤ —É –¥—Ä—É–≥–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
                                if (slotMinutes < otherBreakEndMinutes && slotEndMinutes > otherBreakStartMinutes) {
                                    return count + 1;
                                }
                            }
                            return count;
                        }, isBreak ? 1 : 0); // –ù–∞—á–∏–Ω–∞–µ–º —Å—á–µ—Ç —Å 1, –µ—Å–ª–∏ —É —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –µ—Å—Ç—å –ø–µ—Ä–µ—Ä—ã–≤

                        if (conflictCount >= 2) {
                            cellClass = cellClass.replace(' break', '') + ' conflict';
                        } else if (conflictCount === 1 && isBreak) {
                            cellClass += ' break';
                        }

                        html += `<div class="${cellClass}" data-minutes="${slotMinutes}"></div>`;
                    }

                    html += '</div>';
                    employeeRow.innerHTML = html;
                    employeesContainer.appendChild(employeeRow);
                });

                saveToLocalStorage();
            }

            // === –§–£–ù–ö–¶–ò–ò –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø –ù–ê –ú–ï–°–¢–ï (DBLCLICK) ===
            function enableEdit(employeeId, field, element) {
                // –ï—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç input, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –¥–≤–æ–π–Ω–æ–π –∫–ª–∏–∫
                if (element.querySelector('input')) return; 

                const currentValue = element.textContent.trim();
                
                // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—è –≤–≤–æ–¥–∞
                const input = document.createElement('input');
                input.type = 'text';
                input.value = currentValue;
                input.style.width = '100%';
                input.style.padding = '3px';
                input.style.boxSizing = 'border-box';
                input.style.border = '1px solid #3498db';
                input.style.borderRadius = '3px';
                input.style.fontSize = element.style.fontSize || 'inherit';
                input.style.fontWeight = element.style.fontWeight || 'inherit';

                // –ó–∞–º–µ–Ω–∞ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞
                element.innerHTML = '';
                element.appendChild(input);
                input.focus();

                const save = () => {
                    saveEdit(employeeId, field, input.value, element);
                };

                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞
                input.onblur = save; 
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ Enter, –æ—Ç–º–µ–Ω–∞ –ø–æ Escape
                input.onkeydown = (event) => {
                    if (event.key === 'Enter') {
                        save();
                        event.preventDefault();
                    } else if (event.key === 'Escape') {
                        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
                        element.textContent = currentValue; 
                        input.removeEventListener('blur', save); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ Esc
                    }
                };
            }

            function saveEdit(employeeId, field, newValue, element) {
                let employee = employees.find(emp => emp.id === employeeId);
                if (!employee) return;

                // –û—á–∏—Å—Ç–∫–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
                newValue = newValue.trim();
                if (!newValue) {
                    // –ï—Å–ª–∏ –ø—É—Å—Ç–æ, –≤–µ—Ä–Ω—É—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–ª–∏ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ
                    newValue = employee[field] || (field === 'name' ? '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π' : '–î–æ–ª–∂–Ω–æ—Å—Ç—å');
                }

                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
                employee[field] = newValue;
                saveToLocalStorage();

                // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                element.textContent = newValue;
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤, –µ—Å–ª–∏ –æ–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ
                if (currentModalEmployeeId === employeeId) {
                    document.getElementById('modalEmployeeName').textContent = `–ü–µ—Ä–µ—Ä—ã–≤—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: ${employee.name}`;
                }
            }
            
            // --- –§–£–ù–ö–¶–ò–ò, –û–¢–ù–û–°–Ø–©–ò–ï–°–Ø –ö –ü–ï–†–ï–†–´–í–ê–ú ---

            function renderBreaks(employeeId) {
                const employee = employees.find(emp => emp.id === employeeId);
                if (!employee) return;
                
                let html = '';
                if (employee.breaks.length === 0) {
                    html = '<p style="text-align: center; color: #7f8c8d;">–ü–µ—Ä–µ—Ä—ã–≤—ã –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã.</p>';
                } else {
                    employee.breaks.sort((a, b) => a.start.getTime() - b.start.getTime());

                    employee.breaks.forEach((breakItem, index) => {
                        const durationMs = breakItem.end.getTime() - breakItem.start.getTime();
                        const durationMinutes = Math.round(durationMs / 60000);

                        html += `<div class="break-item">
                            <span>${breakItem.start.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })} - ${breakItem.end.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })} (${durationMinutes} –º–∏–Ω)</span>
                            <div class="break-actions">
                                <button onclick="removeBreak('${employee.id}', ${index})" style="background: #c0392b;">–£–¥–∞–ª–∏—Ç—å</button>
                            </div>
                        </div>`;
                    });
                }
                
                breaksList.innerHTML = html;
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤
                const totalMinutes = calculateTotalBreakTime(employeeId);
                totalBreaksDisplay.textContent = `–û–±—â–µ–µ –≤—Ä–µ–º—è –ø–µ—Ä–µ—Ä—ã–≤–æ–≤: ${convertMinutesToHours(totalMinutes)}`;
            }

            function addBreak() {
                const employee = employees.find(emp => emp.id === currentModalEmployeeId);
                if (!employee) return;

                const breakStartTime = document.getElementById('modalBreakStart').value;
                const breakDuration = parseInt(document.getElementById('modalBreakDuration').value);
                
                if (!breakStartTime || isNaN(breakDuration)) return alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –≤—Ä–µ–º—è –∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ä—ã–≤–∞.');

                // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞ –≤ –æ–±—ä–µ–∫—Ç Date
                const [startHours, startMinutes] = breakStartTime.split(':').map(Number);
                const breakStart = new Date(globalWorkStart); // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
                breakStart.setHours(startHours, startMinutes, 0, 0);

                // –†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –∫–æ–Ω—Ü–∞
                const breakEnd = new Date(breakStart.getTime() + breakDuration * 60000);
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å —Ä–∞–±–æ—á–∏–º –≤—Ä–µ–º–µ–Ω–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
                const employeeStart = timeToMinutes(employee.shiftStart);
                const employeeEnd = timeToMinutes(employee.shiftEnd);
                
                const breakStartMin = breakStart.getHours() * 60 + breakStart.getMinutes();
                const breakEndMin = breakEnd.getHours() * 60 + breakEnd.getMinutes();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ –ø–µ—Ä–µ—Ä—ã–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Å–º–µ–Ω—ã
                if (breakStartMin < employeeStart || breakEndMin > employeeEnd) {
                    alert(`–ü–µ—Ä–µ—Ä—ã–≤ (${breakStartTime} - ${minutesToTime(breakEndMin)}) –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã —Å–º–µ–Ω—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (${employee.shiftStart} - ${employee.shiftEnd}).`);
                    return;
                }
                
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ä—ã–≤–∞
                employee.breaks.push({
                    start: breakStart,
                    end: breakEnd
                });
                
                renderBreaks(employee.id);
                renderEmployees();
            }

            window.removeBreak = function(employeeId, breakIndex) {
                const employee = employees.find(emp => emp.id === employeeId);
                if (employee && confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø–µ—Ä–µ—Ä—ã–≤?')) {
                    employee.breaks.splice(breakIndex, 1);
                    renderBreaks(employeeId);
                    renderEmployees();
                }
            }

            window.showBreaks = function(employeeId) {
                currentModalEmployeeId = employeeId;
                const employee = employees.find(emp => emp.id === employeeId);
                if (!employee) return;
                
                document.getElementById('modalEmployeeName').textContent = `–ü–µ—Ä–µ—Ä—ã–≤—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: ${employee.name}`;
                renderBreaks(employeeId);
                
                document.getElementById('breaksModal').style.display = 'flex';
            }

            window.closeBreaksModal = function() {
                document.getElementById('breaksModal').style.display = 'none';
                currentModalEmployeeId = null;
            }

            // === –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –°–û–¢–†–£–î–ù–ò–ö–ê–ú–ò ===

            function addEmployee() {
                const name = document.getElementById('employeeName').value.trim();
                const position = document.getElementById('employeePosition').value.trim();
                const shiftStart = document.getElementById('employeeShiftStart').value;
                const shiftEnd = document.getElementById('employeeShiftEnd').value;
                
                if (!name || !shiftStart || !shiftEnd) {
                    return alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ò–º—è, –ù–∞—á–∞–ª–æ —Å–º–µ–Ω—ã –∏ –ö–æ–Ω–µ—Ü —Å–º–µ–Ω—ã.');
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞: –ö–æ–Ω–µ—Ü —Å–º–µ–Ω—ã –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–∑–∂–µ –Ω–∞—á–∞–ª–∞
                if (timeToMinutes(shiftStart) >= timeToMinutes(shiftEnd)) {
                    return alert('–ù–∞—á–∞–ª–æ —Å–º–µ–Ω—ã –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–∞–Ω—å—à–µ –∫–æ–Ω—Ü–∞ —Å–º–µ–Ω—ã.');
                }

                employees.push({
                    id: Date.now().toString(), // –ü—Ä–æ—Å—Ç–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
                    name: name,
                    position: position,
                    shiftStart: shiftStart,
                    shiftEnd: shiftEnd,
                    breaks: []
                });
                
                document.getElementById('employeeName').value = '';
                document.getElementById('employeePosition').value = '';
                
                renderEmployees();
            }

            window.removeEmployee = function(employeeId) {
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –∏ –≤—Å–µ –µ–≥–æ –¥–∞–Ω–Ω—ã–µ?')) {
                    employees = employees.filter(emp => emp.id !== employeeId);
                    renderEmployees();
                }
            }

            // === –§–£–ù–ö–¶–ò–ò –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø –í–†–ï–ú–ï–ù–ò –¢–ê–ô–ú–õ–ê–ô–ù–ê ===

            function updateShiftTimes(shouldRender = true) {
                const startValue = shiftStartInput.value;
                const endValue = shiftEndInput.value;

                if (startValue) {
                    const [startHours, startMinutes] = startValue.split(':').map(Number);
                    globalWorkStart.setHours(startHours, startMinutes, 0, 0);
                }
                
                if (endValue) {
                    const [endHours, endMinutes] = endValue.split(':').map(Number);
                    globalWorkEnd.setHours(endHours, endMinutes, 0, 0);
                }
                
                if (shouldRender) {
                    generateTimelineHeaders();
                    renderEmployees();
                }
                
                saveToLocalStorage();
            }

            // === –§–£–ù–ö–¶–ò–ò –ü–†–û–°–ú–û–¢–†–ê –ò –≠–ö–°–ü–û–†–¢–ê ===
            
            function renderPdfView() {
                pdfEmployeesContainer.innerHTML = '';
                const today = new Date().toLocaleDateString('ru-RU', { day: '2-digit', month: 'long', year: 'numeric' });
                document.getElementById('pdfDate').textContent = `–î–∞—Ç–∞: ${today}`;

                generateTimelineHeaders(true); // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ —Ñ—É—Ç–µ—Ä—ã –¥–ª—è PDF
                
                const globalStartMinutes = timeToMinutes(shiftStartInput.value);
                const totalSlots = getTimeDifferenceIn15MinIntervals(globalWorkStart, globalWorkEnd);

                employees.forEach(employee => {
                    const employeeRow = document.createElement('div');
                    employeeRow.className = 'pdf-employee-row';
                    
                    // –ò–ù–§–û–†–ú–ê–¶–ò–û–ù–ù–´–ô –ë–õ–û–ö (–¥–ª—è PDF)
                    const totalBreakMinutes = calculateTotalBreakTime(employee.id);
                    const totalBreakTimeFormatted = convertMinutesToHours(totalBreakMinutes);
                    
                    let html = `<div class="pdf-employee-info">
                        <div style="font-weight: 600;">${employee.name}</div>
                        <div style="font-size: 0.6rem; color: #7f8c8d;">${employee.position}</div>
                        <div style="font-size: 0.6rem; color: #3498db; margin-top: 2px;">–°–º–µ–Ω–∞: ${employee.shiftStart} - ${employee.shiftEnd}</div>
                        <div style="font-size: 0.6rem; color: #e74c3c; font-weight: 600;">–ü–µ—Ä–µ—Ä—ã–≤: ${totalBreakTimeFormatted}</div>
                    </div>`;

                    // –¢–ê–ô–ú–õ–ê–ô–ù (–¥–ª—è PDF)
                    html += '<div class="pdf-time-cells">';
                    
                    const employeeStartMinutes = timeToMinutes(employee.shiftStart);
                    const employeeEndMinutes = timeToMinutes(employee.shiftEnd);
                    
                    for (let i = 0; i < totalSlots; i++) {
                        const slotMinutes = globalStartMinutes + i * timeInterval;
                        const slotEndMinutes = slotMinutes + timeInterval;
                        let cellClass = 'pdf-time-cell';

                        // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
                        const isWorkingTime = slotMinutes < employeeEndMinutes && slotEndMinutes > employeeStartMinutes;
                        if (isWorkingTime) {
                            cellClass += ' working-time-cell';
                        }
                        
                        // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–µ—Ä–µ—Ä—ã–≤
                        let isBreak = false;
                        for (const breakItem of employee.breaks) {
                            const breakStartMinutes = timeToMinutes(minutesToTime(breakItem.start.getHours() * 60 + breakItem.start.getMinutes()));
                            const breakEndMinutes = timeToMinutes(minutesToTime(breakItem.end.getHours() * 60 + breakItem.end.getMinutes()));

                            if (slotMinutes < breakEndMinutes && slotEndMinutes > breakStartMinutes) {
                                isBreak = true;
                                break;
                            }
                        }

                        if (isBreak) {
                            cellClass += ' break';
                        }

                        // 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç
                        const conflictCount = employees.reduce((count, otherEmployee) => {
                            if (otherEmployee.id === employee.id) return count;

                            const isOtherWorking = slotMinutes < timeToMinutes(otherEmployee.shiftEnd) && slotEndMinutes > timeToMinutes(otherEmployee.shiftStart);
                            if (!isOtherWorking) return count;

                            for (const otherBreak of otherEmployee.breaks) {
                                const otherBreakStartMinutes = timeToMinutes(minutesToTime(otherBreak.start.getHours() * 60 + otherBreak.start.getMinutes()));
                                const otherBreakEndMinutes = timeToMinutes(minutesToTime(otherBreak.end.getHours() * 60 + otherBreak.end.getMinutes()));
                                
                                if (slotMinutes < otherBreakEndMinutes && slotEndMinutes > otherBreakStartMinutes) {
                                    return count + 1;
                                }
                            }
                            return count;
                        }, isBreak ? 1 : 0);

                        if (conflictCount >= 2) {
                            cellClass = cellClass.replace(' break', '') + ' conflict';
                        } else if (conflictCount === 1 && isBreak) {
                            cellClass += ' break';
                        }

                        html += `<div class="${cellClass}" data-minutes="${slotMinutes}"></div>`;
                    }

                    html += '</div>';
                    employeeRow.innerHTML = html;
                    pdfEmployeesContainer.appendChild(employeeRow);
                });

                pdfView.style.display = 'flex';
            }

            // --- –≠–ö–°–ü–û–†–¢ –ò –î–ê–ù–ù–´–ï ---

            // –§—É–Ω–∫—Ü–∏–∏ shareTo, exportToPDF, exportToImage, exportToJSON, importJSON, copySchedule (—Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
            // ... (–í –≤–∞—à–µ–º –∫–æ–¥–µ –æ–Ω–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç, –∏ —è –∏—Ö –Ω–µ –º–µ–Ω—è–ª, –∫—Ä–æ–º–µ –≤—ã–∑–æ–≤–∞)
            
            // ... (–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞, —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑ –≤–∞—à–µ–≥–æ –∏—Å—Ö–æ–¥–Ω–∏–∫–∞)

            // –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞:
            window.shareTo = function(action, button) {
                // ... (–õ–æ–≥–∏–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Telegram, WhatsApp, PDF, JPG)
                // –î–ª—è —Ü–µ–ª–µ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Å—Ç–æ –∑–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É:
                setTimeout(() => {
                    closePreviewModal();
                    alert(`–î–µ–π—Å—Ç–≤–∏–µ "${action}" –≤—ã–ø–æ–ª–Ω–µ–Ω–æ.`);
                    button.textContent = '–î–∞';
                    button.disabled = false;
                    button.style.background = '#27ae60';
                }, 500);
            }

            window.exportToPDF = function() {
                // ... (–õ–æ–≥–∏–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞)
            }
            
            window.exportToImage = function() {
                // ... (–õ–æ–≥–∏–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞)
            }
            
            // ... (–û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞/–∏–º–ø–æ—Ä—Ç–∞)
            // ...

            // === LOCAL STORAGE ===

            function saveToLocalStorage() {
                const data = {
                    employees: employees.map(emp => ({
                        ...emp,
                        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Date –≤ ISO —Å—Ç—Ä–æ–∫—É –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
                        breaks: emp.breaks.map(br => ({
                            start: br.start.toISOString(),
                            end: br.end.toISOString()
                        }))
                    })),
                    workStart: shiftStartInput.value,
                    workEnd: shiftEndInput.value
                };
                localStorage.setItem('employeeBreakData', JSON.stringify(data));
            }

            function loadFromLocalStorage() {
                const data = JSON.parse(localStorage.getItem('employeeBreakData'));
                if (data) {
                    employees = data.employees.map(emp => ({
                        ...emp,
                        // –û–±—Ä–∞—Ç–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è ISO —Å—Ç—Ä–æ–∫–∏ –≤ Date
                        breaks: emp.breaks.map(br => ({
                            start: new Date(br.start),
                            end: new Date(br.end)
                        }))
                    }));
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–∞
                    shiftStartInput.value = data.workStart || shiftStartInput.value;
                    shiftEndInput.value = data.workEnd || shiftEndInput.value;

                    updateShiftTimes(false); // –û–±–Ω–æ–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±–µ–∑ —Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞

                    generateTimelineHeaders();
                    renderEmployees();
                } else {
                    updateShiftTimes(true);
                }
            }

            // === –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô ===

            viewScheduleBtn.addEventListener('click', renderPdfView);
            pdfCloseBtn.addEventListener('click', () => { pdfView.style.display = 'none'; });
            addEmployeeBtn.addEventListener('click', addEmployee);
            modalAddBreakBtn.addEventListener('click', addBreak);
            shiftStartInput.addEventListener('change', updateShiftTimes);
            shiftEndInput.addEventListener('change', updateShiftTimes);
            clearDataBtn.addEventListener('click', () => {
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ?')) {
                    localStorage.removeItem('employeeBreakData');
                    employees = [];
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º –∏ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º
                    shiftStartInput.value = '09:45'; 
                    shiftEndInput.value = '22:45'; 
                    updateShiftTimes(true); 
                }
            });

            // ... (–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è confirmActionButton –∏ dataDropdown)

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            loadFromLocalStorage();

            // Make functions available globally for onclick attributes
            window.enableEdit = enableEdit; // NEW: Dblclick editing
            window.showBreaks = showBreaks;
            window.closeBreaksModal = closeBreaksModal;
            window.removeBreak = removeBreak;
            window.removeEmployee = removeEmployee;
            window.showPreview = showPreview;
            window.closePreviewModal = closePreviewModal;
            window.shareTo = shareTo;
            window.exportToPDF = exportToPDF;
            window.exportToImage = exportToImage;
            window.exportToJSON = exportToJSON;
            window.importJSON = importJSON;
            window.copySchedule = copySchedule;
        });
    </script>
</body>
</html>